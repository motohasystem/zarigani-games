# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

# プロジェクト概要
- **ゲーム名**: ザリガニ大決戦
- **ジャンル**: マウス追従型アクション成長ゲーム
- **プラットフォーム**: ブラウザ（HTML5/JavaScript Canvas）
- **制限時間**: 60秒

## ゲーム仕様
### 基本ルール
- マウスカーソルに向かってザリガニが移動
- 目標地点の半径10ピクセル以内に到着すると慣性移動モードに切り替わり、現在の速度ベクトルを維持して直進
- マウスカーソルが5ピクセル以上移動すると慣性移動モードが解除され、再びマウス追従に戻る
- 自分より小さなザリガニを食べて成長
- 自分より大きなザリガニに食べられるとライフが減る（初期ライフ3）
- 制限時間内に高スコアを目指す

### 成長システム
- 成長量: `(敵のサイズ / 8) × 1.5`（最小成長量: 3）
- スコア: 敵のサイズ + サイズボーナス
- サイズ表示: 指数関数的増加（400 × (サイズ/20)² メートル）

### 敵の出現確率
- 69%: 通常サイズ（15-50px）
- 20%: 大きなザリガニ（50-80px）
- 10%: 巨大ザリガニ（80-120px）
- 1%: 超巨大ザリガニ（150-200px）

### 特殊機能
- 5秒間食べられないと自動的に食べられるサイズのザリガニが出現
- 食べられるザリガニには緑色のサークルが表示
- 日本地図と周辺大陸の背景（成長に応じて縮小）
- ムシャムシャ音の食べる効果音

### プレイヤー移動システム
- **通常モード**: マウスカーソルに向かって移動（距離10ピクセル以上）
- **慣性移動モード**: 現在の速度ベクトルを維持して直進
- **モード切り替え条件**:
  - 通常 → 慣性: 目標地点の半径10ピクセル以内に到着
  - 慣性 → 通常: マウスカーソルが5ピクセル以上移動

## ファイル構成
- `index.html` - メインのHTMLファイル、ゲームの基本構造
- `game.js` - ゲームロジック、Canvas描画処理、各種クラス定義
- `style.css` - UIスタイリング
- `resource/` - 画像リソース
  - `zarigani.png` - ザリガニの透過PNG画像
  - `surume.png` - スルメの画像
  - `surume_whole.png` - 完全なスルメの画像

## 開発環境
- 静的ファイルのため、ローカルサーバーで動作確認
- `python -m http.server 8000` または Live Server拡張機能を使用
- モダンブラウザ対応（Canvas、Web Audio API使用）

## アーキテクチャ
### クラス構造
- **ZariganiGrowthGame**: メインゲームクラス、ゲーム状態管理
- **Zarigani**: ザリガニオブジェクト（プレイヤー・敵）
  - `inertiaMode`: 慣性移動モードフラグ
  - `targetX`, `targetY`: 移動目標座標
  - `update()`: 通常の移動処理
  - `stop()`: 即座停止

### ゲーム状態
- `menu` - タイトル画面
- `playing` - ゲーム中
- `gameOver` - ゲーム終了

### 重要なパラメータ
- `worldSize`: 2000（ゲーム世界のサイズ）
- `maxEnemies`: 30（最大敵数）
- `timeLeft`: 60（制限時間）
- `playerLife`: 3（プレイヤーライフ）

## 音響システム
- Web Audio APIを使用してリアルタイム効果音生成
- `playEatingSound()`: 3回連続の食べる音（ムシャムシャ）
- `playSound()`: 汎用効果音（ダメージ音等）

## 視覚システム
### 背景地図
- 日本列島（本州、北海道、九州、四国）
- 周辺大陸（朝鮮半島、中国、台湾、フィリピン、サハリン、ロシア極東）
- 成長に応じて動的スケール変更

### カメラシステム
- プレイヤー追従カメラ
- 成長に応じた自動ズームアウト
- スムーズなアニメーション

## 開発コマンド
```bash
# ローカルサーバーを起動（Python）
python -m http.server 8000

# ローカルサーバーを起動（Node.js）
npx serve .
```

## 実行方法
1. ローカルサーバーを起動
2. ブラウザで `http://localhost:8000` にアクセス
3. index.htmlを開く

## デバッグ機能
- **Dキー**: デバッグモードの切り替え
- **デバッグ情報**:
  - マウス座標（ワールド座標）
  - プレイヤー座標
  - プレイヤー速度
  - 慣性移動モード状態
  - カメラ情報（位置・スケール）
  - 最後のマウス更新からの経過時間